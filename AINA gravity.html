<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AINA - Asisten Cerdas Masisir</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- SUPABASE CLIENT CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { 
            font-family: 'Poppins', sans-serif; 
            background-color: #05020a; /* Deep Dark Base */
            color: white; 
            /* FIXED BACKGROUND: Clean, Minimalist, Elegant */
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(126, 34, 206, 0.15) 0%, transparent 60%), /* Very Soft Purple Top Light */
                radial-gradient(circle at 100% 100%, rgba(20, 10, 40, 0.5) 0%, transparent 50%); /* Dark Depth Bottom */
            background-attachment: fixed; 
            background-size: cover;
            overflow-x: hidden; /* STRICTLY PREVENT HORIZONTAL SCROLL */
            width: 100vw;
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(139, 92, 246, 0.3); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(139, 92, 246, 0.5); }
        
        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        .glass-panel:hover {
            border: 1px solid rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.05);
        }

        /* Sidebar Glass */
        .glass-sidebar {
            background: rgba(5, 2, 10, 0.95);
            backdrop-filter: blur(25px) saturate(180%);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Chat Styling */
        .bubble-user {
            background: linear-gradient(135deg, #7c3aed 0%, #db2777 100%);
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .bubble-ai {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .chat-bg-pattern {
            background-image: radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Hero Title Gradient */
        .hero-title-gradient {
            background: linear-gradient(135deg, #e9d5ff 0%, #a855f7 50%, #fbbf24 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(168, 85, 247, 0.2);
        }

        /* Purple Glow Blob */
        .purple-blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            z-index: 0;
            pointer-events: none;
            opacity: 0.2;
            max-width: 100%;
        }

        /* Animations */
        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.95) translateY(10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        .msg-animate { animation: popIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Hide scrollbar for clean look in some divs */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        /* Icon Utilities */
        .icon-white { filter: brightness(0) invert(1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- SUPABASE CONFIGURATION ---
        const supabaseUrl = 'YOUR_SUPABASE_URL';
        const supabaseKey = 'YOUR_SUPABASE_KEY';
        
        let supabase = null;
        
        if (supabaseUrl && supabaseUrl !== 'YOUR_SUPABASE_URL' && supabaseUrl.startsWith('http')) {
            try {
                supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
            } catch (e) {
                console.error("Gagal inisialisasi Supabase:", e);
            }
        }

        // --- FLATICON HELPER COMPONENT ---
        const Flaticon = ({ src, size = 24, className = "", alt = "icon", forceWhite = true }) => (
            <img 
                src={src} 
                alt={alt}
                width={size} 
                height={size}
                style={{ width: size, height: size, minWidth: size }}
                className={`object-contain transition-all duration-300 ${forceWhite ? 'icon-white' : ''} ${className}`} 
            />
        );

        // --- ICON MAPPING (SIMPLE FLAT STYLE) ---
        const flaticonMap = {
            // UI Basics
            Menu: { src: "https://cdn-icons-png.flaticon.com/128/2976/2976215.png" },
            X: { src: "https://cdn-icons-png.flaticon.com/128/2976/2976286.png" },
            ArrowRight: { src: "https://cdn-icons-png.flaticon.com/128/271/271228.png" },
            ArrowLeft: { src: "https://cdn-icons-png.flaticon.com/128/271/271220.png" },
            ChevronRight: { src: "https://cdn-icons-png.flaticon.com/128/2985/2985179.png" },
            ChevronLeft: { src: "https://cdn-icons-png.flaticon.com/128/2985/2985161.png" },
            ChevronDown: { src: "https://cdn-icons-png.flaticon.com/128/2985/2985150.png" },
            Search: { src: "https://cdn-icons-png.flaticon.com/128/622/622669.png" },
            Check: { src: "https://cdn-icons-png.flaticon.com/128/5610/5610944.png" },
            Edit3: { src: "https://cdn-icons-png.flaticon.com/128/1828/1828911.png" },
            PanelLeftClose: { src: "https://cdn-icons-png.flaticon.com/128/271/271220.png" },
            PanelLeftOpen: { src: "https://cdn-icons-png.flaticon.com/128/271/271228.png" },
            Send: { src: "https://cdn-icons-png.flaticon.com/128/2983/2983788.png" },
            RefreshCw: { src: "https://cdn-icons-png.flaticon.com/128/2805/2805355.png" },
            
            // App Features
            Bot: { src: "https://cdn-icons-png.flaticon.com/128/4712/4712027.png" },
            Home: { src: "https://i.postimg.cc/ZRmf88vr/home.png" },
            MessageSquare: { src: "https://i.postimg.cc/xCQsvvNf/chat.png" },
            MessageCircle: { src: "https://cdn-icons-png.flaticon.com/128/1380/1380338.png" },
            Newspaper: { src: "https://i.postimg.cc/Jn8TNNHk/megaphone.png" },
            LayoutGrid: { src: "https://i.postimg.cc/C10vGGnk/ecommerce.png" },
            Handshake: { src: "https://i.postimg.cc/7L0sJshJ/handshake.png" },
            User: { src: "https://cdn-icons-png.flaticon.com/128/1077/1077114.png" },
            Users: { src: "https://cdn-icons-png.flaticon.com/128/1256/1256650.png" },
            BrainCircuit: { src: "https://cdn-icons-png.flaticon.com/128/2083/2083213.png" },
            Sparkles: { src: "https://cdn-icons-png.flaticon.com/128/616/616490.png" },
            Zap: { src: "https://cdn-icons-png.flaticon.com/128/9425/9425785.png" },
            MapPin: { src: "https://cdn-icons-png.flaticon.com/128/447/447031.png" },
            Globe: { src: "https://cdn-icons-png.flaticon.com/128/921/921490.png" },
            Plane: { src: "https://cdn-icons-png.flaticon.com/128/2200/2200329.png" },
            Camera: { src: "https://cdn-icons-png.flaticon.com/128/2985/2985531.png" },
            BookOpen: { src: "https://cdn-icons-png.flaticon.com/128/2232/2232688.png" },
            Bus: { src: "https://cdn-icons-png.flaticon.com/128/3066/3066259.png" },
            FileText: { src: "https://cdn-icons-png.flaticon.com/128/2965/2965335.png" },
            FileSignature: { src: "https://cdn-icons-png.flaticon.com/128/1570/1570998.png" },
            GraduationCap: { src: "https://cdn-icons-png.flaticon.com/128/3135/3135810.png" },
            Key: { src: "https://cdn-icons-png.flaticon.com/128/3588/3588289.png" },
            Clock: { src: "https://cdn-icons-png.flaticon.com/128/2088/2088617.png" },
            Calendar: { src: "https://cdn-icons-png.flaticon.com/128/2693/2693507.png" },
            Coins: { src: "https://cdn-icons-png.flaticon.com/128/2460/2460494.png" },
            ShoppingBag: { src: "https://cdn-icons-png.flaticon.com/128/3514/3514210.png" },
            Library: { src: "https://cdn-icons-png.flaticon.com/128/2232/2232688.png" },
            Target: { src: "https://cdn-icons-png.flaticon.com/128/3176/3176366.png" },
            Lock: { src: "https://cdn-icons-png.flaticon.com/128/2889/2889676.png" },
            Loader2: { src: "https://cdn-icons-png.flaticon.com/128/14427/14427546.png" },
            Sun: { src: "https://cdn-icons-png.flaticon.com/128/869/869869.png" },
            Moon: { src: "https://cdn-icons-png.flaticon.com/128/1239/1239794.png" },
            Sunrise: { src: "https://cdn-icons-png.flaticon.com/128/1163/1163765.png" },
            Sunset: { src: "https://cdn-icons-png.flaticon.com/128/1163/1163736.png" },
            Quote: { src: "https://cdn-icons-png.flaticon.com/128/9906/9906567.png" },
            Save: { src: "https://cdn-icons-png.flaticon.com/128/2874/2874091.png" },
            Mail: { src: "https://cdn-icons-png.flaticon.com/128/542/542689.png" },
            LogIn: { src: "https://cdn-icons-png.flaticon.com/128/3580/3580154.png" },
            LogOut: { src: "https://cdn-icons-png.flaticon.com/128/3580/3580178.png" },
            UserPlus: { src: "https://cdn-icons-png.flaticon.com/128/1077/1077114.png" },
            UserCog: { src: "https://cdn-icons-png.flaticon.com/128/1077/1077114.png" },
            ShieldCheck: { src: "https://cdn-icons-png.flaticon.com/128/1161/1161388.png" },
            AlertTriangle: { src: "https://cdn-icons-png.flaticon.com/128/595/595067.png" },
            AlertCircle: { src: "https://cdn-icons-png.flaticon.com/128/595/595067.png" },
            ShieldAlert: { src: "https://cdn-icons-png.flaticon.com/128/595/595067.png" },
            AlertOctagon: { src: "https://cdn-icons-png.flaticon.com/128/595/595067.png" },
            CheckCircle2: { src: "https://cdn-icons-png.flaticon.com/128/4436/4436481.png" },
            LayoutDashboard: { src: "https://cdn-icons-png.flaticon.com/128/10292/10292350.png" },
            ArrowUpRight: { src: "https://cdn-icons-png.flaticon.com/128/271/271228.png" },
            Languages: { src: "https://cdn-icons-png.flaticon.com/128/921/921490.png" },
            Pencil: { src: "https://cdn-icons-png.flaticon.com/128/1159/1159633.png" },
            Award: { src: "https://cdn-icons-png.flaticon.com/128/3176/3176366.png" },
            Crown: { src: "https://i.postimg.cc/NG6DcJPF/pricing.png" },
            Ticket: { src: "https://cdn-icons-png.flaticon.com/128/281/281769.png" },
        };

        const createIcon = (name) => (props) => {
            const iconDef = flaticonMap[name] || { src: "https://cdn-icons-png.flaticon.com/128/739/739249.png" };
            return <Flaticon src={iconDef.src} {...props} />;
        };

        const Icons = Object.keys(flaticonMap).reduce((acc, name) => {
            acc[name] = createIcon(name);
            return acc;
        }, {});

        const { 
            ArrowRight, MessageCircle, MapPin, BookOpen, Home, Bus, FileText, Zap, Users, 
            LayoutGrid, Search, Menu, X, ChevronRight, Sparkles, Send, Loader2, UserCog, 
            BrainCircuit, Save, Lock, Bot, Library, ShoppingBag, ArrowLeft, Plane, Globe, Handshake, 
            Clock, Calendar, Newspaper, FileSignature, Key, GraduationCap, MessageSquare, 
            Coins, User, Camera, Target, Edit3, PanelLeftClose, Moon, Sun, Sunrise, Sunset, Quote, Check, RefreshCw, Crown, Ticket, Languages
        } = Icons;

        // --- COMPONENTS ---
        const FormattedMessage = ({ text }) => {
            if (!text) return null;
            const parseInline = (str) => {
                let parts = str.split(/(\*\*.*?\*\*)/g);
                return parts.map((part, index) => {
                    if (part.startsWith('**') && part.endsWith('**')) {
                        return <strong key={`b-${index}`} className="text-purple-300 font-bold">{part.slice(2, -2)}</strong>;
                    }
                    return part; 
                });
            };
            const lines = text.split('\n');
            const elements = [];
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line.startsWith('### ')) elements.push(<h4 key={i} className="text-lg font-bold text-purple-300 mt-4 mb-2">{parseInline(line.substring(4))}</h4>);
                else if (line.startsWith('## ')) elements.push(<h3 key={i} className="text-xl font-bold text-white mt-5 mb-3">{parseInline(line.substring(3))}</h3>);
                else if (line.startsWith('- ') || line.startsWith('* ')) elements.push(<div key={i} className="flex gap-3 pl-1 mb-1"><div className="w-1.5 h-1.5 rounded-full bg-purple-500 mt-2.5 shrink-0"></div><span className="text-gray-200 leading-relaxed text-lg">{parseInline(line.substring(2))}</span></div>);
                else if (line === '') elements.push(<div key={i} className="h-2"></div>); 
                else elements.push(<p key={i} className="mb-1 text-gray-200 leading-relaxed text-lg">{parseInline(line)}</p>);
            }
            return <div className="text-sm md:text-base">{elements}</div>;
        };

        // --- NEWS PAGE COMPONENT ---
        const NewsPage = () => {
            const newsData = [
                { id: 1, title: "Pendaftaran Beasiswa Al-Azhar 2025 Dibuka", date: "25 Nov 2025", category: "Akademik", desc: "Kemenag RI resmi membuka seleksi beasiswa & non-beasiswa. Siapkan berkasmu!" },
                { id: 2, title: "Jadwal Perpanjangan Visa Terbaru", date: "24 Nov 2025", category: "Birokrasi", desc: "Kantor Jawazat Nasr City merilis jam operasional baru selama musim dingin. Cek detailnya." },
                { id: 3, title: "Olimpiade Sains & Seni PPMI Mesir", date: "22 Nov 2025", category: "Event", desc: "Ajang kompetisi tahunan terbesar mahasiswa Indonesia di Mesir segera dimulai." },
                { id: 4, title: "Tips Aman Belanja di Pasar 10", date: "20 Nov 2025", category: "Tips", desc: "Hindari harga turis! Ini panduan tawar-menawar bahasa 'Ammiyah buat pemula." }
            ];

            return (
                <div className="p-8 md:p-12 max-w-7xl mx-auto">
                    <div className="mb-10 flex items-center justify-between border-b border-white/10 pb-6">
                        <div>
                            <h1 className="text-2xl md:text-4xl font-bold mb-2">Info Penting Masisir</h1>
                            <p className="text-gray-400 text-sm md:text-base">Kabar terbaru seputar kampus, birokrasi, dan komunitas.</p>
                        </div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {newsData.map(n => (
                            <div key={n.id} className="glass-panel rounded-2xl overflow-hidden group cursor-pointer hover:-translate-y-2 transition-all duration-300">
                                <div className="h-48 bg-purple-900/20 relative flex items-center justify-center overflow-hidden">
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                    <Newspaper size={48} />
                                    <span className="absolute top-4 left-4 text-[10px] bg-purple-600 text-white px-3 py-1 rounded-full font-bold uppercase tracking-wider shadow-lg">{n.category}</span>
                                </div>
                                <div className="p-6">
                                    <div className="flex items-center gap-2 text-xs text-purple-300 mb-3 font-medium"><Calendar size={12}/> {n.date}</div>
                                    <h3 className="font-bold text-lg md:text-xl mb-3 leading-tight group-hover:text-purple-400 transition-colors">{n.title}</h3>
                                    <p className="text-sm text-gray-400 line-clamp-2 mb-4">{n.desc}</p>
                                    <span className="text-xs font-bold text-white flex items-center gap-2 group-hover:gap-3 transition-all uppercase tracking-wide">Baca Selengkapnya <ArrowRight size={14}/></span>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // --- LIVE CLOCK WIDGET ---
        const LiveClockWidget = () => {
            const [time, setTime] = useState(new Date());
            const [zone, setZone] = useState('Cairo');

            useEffect(() => {
                const timer = setInterval(() => setTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            const getTimeData = (tz) => {
                const options = { timeZone: tz, hour12: false };
                const timeStr = time.toLocaleTimeString('id-ID', { ...options, hour: '2-digit', minute: '2-digit', second: '2-digit' });
                const dateStr = time.toLocaleDateString('id-ID', { ...options, weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
                return { timeStr, dateStr };
            };

            const { timeStr, dateStr } = getTimeData(zone === 'Cairo' ? 'Africa/Cairo' : 'Asia/Jakarta');

            return (
                <div className="bg-gradient-to-r from-purple-900/20 to-black p-4 rounded-xl border border-white/10 mt-4 backdrop-blur-md relative overflow-hidden group">
                    <div className="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition-opacity"><Clock size={40}/></div>
                    <div className="flex justify-between items-start mb-2 relative z-10">
                        <div>
                            <span className="text-[10px] font-bold tracking-widest text-purple-400 uppercase mb-1 block">Live Time</span>
                            <button onClick={() => setZone(zone === 'Cairo' ? 'Jakarta' : 'Cairo')} className="flex items-center gap-2 bg-white/10 hover:bg-white/20 px-2 py-1 rounded-lg transition-all border border-white/5">
                                <span className="text-xs text-white font-bold">{zone === 'Cairo' ? 'ðŸ‡ªðŸ‡¬ Kairo' : 'ðŸ‡®ðŸ‡© Indonesia'}</span>
                                <RefreshCw size={10} className="text-gray-400"/>
                            </button>
                        </div>
                    </div>
                    <div className="text-center py-1 relative z-10">
                        <div className="text-3xl font-mono font-bold text-white tracking-wider shadow-black drop-shadow-lg">{timeStr}</div>
                        <div className="text-xs text-gray-400 mt-1 font-medium">{dateStr}</div>
                    </div>
                </div>
            );
        };

        const PrayerTimesWidget = () => {
            const [prayers, setPrayers] = useState(null);
            useEffect(() => {
                const fetchPrayers = async () => {
                    try {
                        const date = new Date();
                        const response = await fetch(`https://api.aladhan.com/v1/timingsByCity/${date.getDate()}-${date.getMonth()+1}-${date.getFullYear()}?city=Cairo&country=Egypt&method=5`);
                        const data = await response.json();
                        if (data.code === 200) setPrayers(data.data.timings);
                    } catch (err) {
                        setPrayers({ Fajr: "04:30", Dhuhr: "12:00", Asr: "15:30", Maghrib: "18:00", Isha: "19:30" });
                    }
                };
                fetchPrayers();
            }, []);

            if (!prayers) return <div className="animate-pulse h-24 bg-white/5 rounded-xl mt-4"></div>;

            return (
                <div className="bg-gradient-to-br from-[#0A0217] to-purple-900/20 p-4 rounded-xl border border-white/10 mt-6 backdrop-blur-md">
                    <div className="flex justify-between items-center mb-3">
                         <h3 className="text-sm font-bold flex items-center gap-2 text-white"><Clock size={16}/> Jadwal Sholat Kairo</h3>
                         <span className="text-[10px] text-gray-400 bg-white/5 px-2 py-0.5 rounded">EGAS</span>
                    </div>
                    <div className="space-y-2">
                        {[{n:'Subuh',t:prayers.Fajr,i:<Sunrise size={14}/>},{n:'Dzuhur',t:prayers.Dhuhr,i:<Sun size={14}/>},{n:'Ashar',t:prayers.Asr,i:<Sun size={14} className="opacity-70"/>},{n:'Maghrib',t:prayers.Maghrib,i:<Sunset size={14}/>},{n:'Isya',t:prayers.Isha,i:<Moon size={14}/>}].map((p, i) => (
                            <div key={i} className="flex justify-between items-center text-xs p-2 rounded-lg hover:bg-white/5 transition-colors border border-transparent hover:border-white/5 group">
                                <span className="text-gray-300 flex items-center gap-2 group-hover:text-purple-300">{p.i} {p.n}</span>
                                <span className="font-mono font-bold text-white bg-black/30 px-2 py-0.5 rounded">{p.t}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ModelSelector = ({ activeModel, setActiveModel }) => (
            <div className="flex gap-2 mb-4 overflow-x-auto pb-2 scrollbar-hide">
                <button onClick={() => setActiveModel('basic')} className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap border ${activeModel === 'basic' ? 'bg-purple-600 border-purple-500 text-white shadow-lg' : 'bg-white/5 border-white/20 text-white hover:bg-white/10'}`}><Bot size={16} /> AINA Basic</button>
                <button onClick={() => setActiveModel('scholar')} className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap border ${activeModel === 'scholar' ? 'bg-blue-600 border-blue-500 text-white shadow-lg' : 'bg-white/5 border-white/20 text-white hover:bg-white/10'}`}><Library size={16} /> AINA Scholar</button>
                <button onClick={() => setActiveModel('market')} className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap border ${activeModel === 'market' ? 'bg-green-600 border-green-500 text-white shadow-lg' : 'bg-white/5 border-white/20 text-white hover:bg-white/10'}`}><ShoppingBag size={16} /> AINA Market</button>
            </div>
        );

        const CurrencyConverter = () => {
            const [rates, setRates] = useState({ EGP: 320, USD: 15500 }); 
            const [amount, setAmount] = useState(1);
            const [fromCurr, setFromCurr] = useState('EGP');
            const [toCurr, setToCurr] = useState('IDR');
            const [result, setResult] = useState(0);
            const [isEditing, setIsEditing] = useState(false);
            const [tempRates, setTempRates] = useState({ ...rates });
            
            useEffect(() => {
                let valInIDR = (fromCurr === 'IDR') ? amount : amount * rates[fromCurr];
                let finalVal = (toCurr === 'IDR') ? valInIDR : valInIDR / rates[toCurr];
                setResult(finalVal);
            }, [amount, fromCurr, toCurr, rates]);

            const saveRates = () => { setRates(tempRates); setIsEditing(false); };

            return (
                <div className="bg-white/5 p-4 rounded-xl border border-white/10 mt-6 backdrop-blur-md">
                    <div className="flex justify-between items-center mb-3">
                         <h3 className="text-sm font-bold flex items-center gap-2 text-white"><Coins size={16}/> Kurs Hari Ini</h3>
                         <button onClick={() => setIsEditing(!isEditing)} className="text-white hover:text-purple-400 transition-colors"><Edit3 size={14}/></button>
                    </div>
                    {isEditing && (
                        <div className="space-y-2 mb-3 bg-black/40 p-3 rounded-lg text-xs animate-fade-in">
                            <div className="flex justify-between items-center"><span>1 EGP =</span><input type="number" value={tempRates.EGP} onChange={(e) => setTempRates({...tempRates, EGP: parseFloat(e.target.value)})} className="w-16 bg-black/50 border border-white/20 rounded px-1 text-right text-white"/></div>
                            <div className="flex justify-between items-center"><span>1 USD =</span><input type="number" value={tempRates.USD} onChange={(e) => setTempRates({...tempRates, USD: parseFloat(e.target.value)})} className="w-16 bg-black/50 border border-white/20 rounded px-1 text-right text-white"/></div>
                            <button onClick={saveRates} className="w-full bg-green-600/80 hover:bg-green-600 py-1 rounded font-bold mt-1 text-white transition-all">Simpan</button>
                        </div>
                    )}
                    <div className="space-y-3 text-xs">
                        <input type="number" value={amount} onChange={(e) => setAmount(parseFloat(e.target.value) || 0)} className="w-full bg-black/30 border border-white/10 rounded-lg p-2 text-center font-mono focus:border-purple-500 outline-none text-white"/>
                        <div className="flex items-center gap-1">
                            <select value={fromCurr} onChange={(e) => setFromCurr(e.target.value)} className="w-full bg-black/30 border border-white/10 rounded-lg p-1.5 outline-none text-center text-white cursor-pointer">{['IDR', 'EGP', 'USD'].map(c => <option key={c} value={c} className="bg-[#0A0217]">{c}</option>)}</select>
                            <ArrowRight size={12}/>
                            <select value={toCurr} onChange={(e) => setToCurr(e.target.value)} className="w-full bg-black/30 border border-white/10 rounded-lg p-1.5 outline-none text-center text-white cursor-pointer">{['IDR', 'EGP', 'USD'].map(c => <option key={c} value={c} className="bg-[#0A0217]">{c}</option>)}</select>
                        </div>
                        <div className="bg-purple-500/10 border border-purple-500/30 p-2 rounded-lg text-center">
                            <p className="text-lg font-bold text-white font-mono">{result.toLocaleString('id-ID', { maximumFractionDigits: 0 })} <span className="text-[10px] font-normal text-gray-400">{toCurr}</span></p>
                        </div>
                    </div>
                </div>
            );
        };

        const AinaLandingPage = () => {
            const [currentView, setCurrentView] = useState('landing'); 
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [isAuthModalOpen, setIsAuthModalOpen] = useState(false);
            const [isLimitModalOpen, setIsLimitModalOpen] = useState(false);
            const [isRedeemModalOpen, setIsRedeemModalOpen] = useState(false);
            const [authMode, setAuthMode] = useState('login'); 
            const [currentUser, setCurrentUser] = useState(null); 
            const [authLoading, setAuthLoading] = useState(false);
            const [activeModel, setActiveModel] = useState('basic');
            const [chatInput, setChatInput] = useState('');
            const [chatHistory, setChatHistory] = useState([{ role: 'ai', text: 'Ahlan, Masisir! **Gue AINA,** partner lu buat survive dan thrive di Negeri Kinanah. ðŸ‡ªðŸ‡¬âœ¨\n\nMau tanya jadwal talaqi, harga bawang hari ini, atau curhat soal revisian tesis? Gas!' }]);
            const [isAiLoading, setIsAiLoading] = useState(false);
            const [dailyMessageCount, setDailyMessageCount] = useState(0);
            const [isPremium, setIsPremium] = useState(false);
            const [redeemCode, setRedeemCode] = useState("");
            const chatEndRef = useRef(null);
            const fileInputRef = useRef(null);
            const apiKey = ""; 

            const MAX_DAILY_MESSAGES = 10;
            const VALID_CODES = ["AINA-SULTAN", "MASISIR-JAYA", "MABROUK2025"];

            // Initial chat demos - Array of scenarios to pick randomly
            const heroScenarios = [
                { q: "Jadwal kuliah hari ini apa ya? ðŸ“š", a: "Hari ini ada Balaghah sama Syekh Fathi jam 9 pagi." },
                { q: "Visa turis bisa diperpanjang gak? ðŸ›‚", a: "Bisa kok, tapi harus ke Mogamma pagi-pagi banget biar dapet antrian." },
                { q: "Tempat beli kitab murah dimana? ðŸ“–", a: "Coba ke Darus Salam di belakang Azhar, lagi ada diskon tuh." },
                { q: "Rute bus ke Nadi Abbasiyah? ðŸšŒ", a: "Naik bus 106 dari terminal 10, turun pas depan gerbang Nadi." }
            ];
            
            const [heroChat, setHeroChat] = useState(heroScenarios[0]);

            useEffect(() => {
                // Set random scenario on mount (refresh)
                setHeroChat(heroScenarios[Math.floor(Math.random() * heroScenarios.length)]);
            }, []);

            const [userProfile, setUserProfile] = useState({ name: '', photo: null });
            const [knowledgeCategory, setKnowledgeCategory] = useState('');
            const [knowledgeTitle, setKnowledgeTitle] = useState('');
            const [knowledgeInput, setKnowledgeInput] = useState('');
            const [isSaving, setIsSaving] = useState(false);
            const [isEditingName, setIsEditingName] = useState(false);
            const [tempName, setTempName] = useState("");
            const [isSidebarExpanded, setIsSidebarExpanded] = useState(true); 

            const AINA_LOGO = "https://i.postimg.cc/2yjXHm9B/AIGHYPT-MEYUALA.png";

            const getDisplayName = () => userProfile.name || (currentUser && currentUser.email ? currentUser.email.split('@')[0] : 'User');
            const handleSaveName = () => { setUserProfile(prev => ({ ...prev, name: tempName })); setIsEditingName(false); };

            useEffect(() => {
                if (supabase) {
                    supabase.auth.getSession().then(({ data: { session } }) => { if (session) setCurrentUser(session.user); });
                    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => { setCurrentUser(session ? session.user : null); });
                    return () => subscription.unsubscribe();
                }
                const premiumStatus = localStorage.getItem('aina_premium');
                if (premiumStatus === 'true') setIsPremium(true);
            }, []);

            // AUTO SCROLL TO TOP WHEN VIEW CHANGES
            useEffect(() => {
                const scrollContainer = document.getElementById('main-scroll');
                if (scrollContainer) scrollContainer.scrollTop = 0;
                if (currentView === 'chat_app' && chatEndRef.current) chatEndRef.current.scrollIntoView({ behavior: 'smooth' });
            }, [currentView, chatHistory]);

            const handleTrainAiClick = () => { 
                if (currentUser) { setCurrentView('personalize'); } 
                else { setAuthMode('login'); setIsAuthModalOpen(true); } 
            };

            const handleAuthSubmit = async (e) => {
                e.preventDefault();
                if (!supabase) {
                    alert("âš ï¸ Supabase belum dikonfigurasi! (Mode Demo)");
                    setTimeout(() => { setCurrentUser({ email: e.target[0].value, id: 'demo-id' }); setIsAuthModalOpen(false); }, 1000);
                    return;
                }
                setAuthLoading(true);
                try {
                    const { error } = await (authMode === 'login' ? supabase.auth.signInWithPassword({ email: e.target[0].value, password: e.target[1].value }) : supabase.auth.signUp({ email: e.target[0].value, password: e.target[1].value }));
                    if (error) throw error;
                    alert("Berhasil!"); setIsAuthModalOpen(false);
                } catch (error) { alert("Gagal: " + error.message); } finally { setAuthLoading(false); }
            };

            const handleSendData = async () => {
                if (!knowledgeInput.trim() || !knowledgeCategory || !knowledgeTitle.trim()) { alert("Mohon lengkapi Judul, Kategori, dan Isi."); return; }
                setIsSaving(true);
                setTimeout(() => { alert("Syukron! Informasi terkirim."); setIsSaving(false); setKnowledgeInput(''); setKnowledgeTitle(''); }, 1000);
            };

            const handlePhotoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => { setUserProfile(prev => ({ ...prev, photo: reader.result })); };
                    reader.readAsDataURL(file);
                }
            };

            const handleRedeemSubmit = (e) => {
                e.preventDefault();
                if (VALID_CODES.includes(redeemCode.toUpperCase())) {
                    setIsPremium(true);
                    localStorage.setItem('aina_premium', 'true');
                    setIsRedeemModalOpen(false);
                    setIsLimitModalOpen(false); 
                    alert("Kode Berhasil! Selamat datang Sultan AINA. ðŸ‘‘");
                    setRedeemCode("");
                } else {
                    alert("Kode salah atau kadaluarsa! Coba lagi.");
                }
            };

            const handleSubscribe = () => {
                setIsPremium(true);
                setIsLimitModalOpen(false);
                setCurrentView('chat_app');
                alert("Selamat! Akun Anda sekarang Premium. Unlimited Chat Aktif! ðŸŽ‰");
            };

            const getSystemPrompt = (model) => {
                const baseProfile = userProfile.name ? `User bernama ${userProfile.name}.` : 'User adalah mahasiswa Indonesia di Mesir.';
                // Updated Tone Instruction to "Aku-Kamu"
                const formattingInstruction = `FORMAT JAWABAN (PENTING): Gunakan bahasa Indonesia yang luwes, ramah, dan suportif (Gunakan sapaan "Aku-Kamu"). Gunakan **Bold** untuk poin penting. Gunakan format TABEL Markdown jika perlu membandingkan data.`;
                if (model === 'scholar') return `Kamu AINA Scholar, asisten akademik yang pinter tapi asik. ${baseProfile} ${formattingInstruction}`;
                if (model === 'market') return `Kamu AINA Market, asisten logistik & bisnis yang tau harga pasar. ${baseProfile} ${formattingInstruction}`;
                return `Kamu AINA, partner setia Masisir. ${baseProfile} ${formattingInstruction}`;
            };

            const handleSendMessage = async (forcedMessage = null) => {
                const userMessage = forcedMessage || chatInput;
                if (!userMessage.trim()) return;

                // CHECK LIMIT
                if (!isPremium && dailyMessageCount >= MAX_DAILY_MESSAGES) {
                    setIsLimitModalOpen(true);
                    return;
                }

                if(!forcedMessage) setChatInput('');
                
                setChatHistory(prev => [...prev, { role: 'user', text: userMessage }]);
                // Increment Count
                setDailyMessageCount(prev => prev + 1);
                
                setIsAiLoading(true);
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            contents: [{ role: 'user', parts: [{ text: userMessage }] }],
                            systemInstruction: { parts: [{ text: getSystemPrompt(activeModel) }] }
                        }),
                    });
                    const data = await response.json();
                    const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || "Maaf, AINA lagi ngopi bentar (Server Busy). Coba lagi ya!";
                    setChatHistory(prev => [...prev, { role: 'ai', text: aiResponse }]);
                } catch (error) { setChatHistory(prev => [...prev, { role: 'ai', text: "Koneksi error." }]); } finally { setIsAiLoading(false); }
            };

            const handleFeatureClick = (query) => { setCurrentView('chat_app'); setTimeout(() => handleSendMessage(query), 500); };
            const clearChat = () => setChatHistory([{ role: 'ai', text: 'Chat sudah bersih. Mau bahas apa lagi?' }]);

            const navLinks = [
                { name: 'Tentang', icon: <Home size={20} />, href: '#meaning', action: () => { setCurrentView('landing'); setTimeout(() => document.getElementById('meaning')?.scrollIntoView({behavior: 'smooth'}), 100); } },
                { name: 'Fitur', icon: <LayoutGrid size={20} />, href: '#features', action: () => { setCurrentView('landing'); setTimeout(() => document.getElementById('features')?.scrollIntoView({behavior: 'smooth'}), 100); } },
                // --- NAV LINK UNTUK BERITA SUDAH SAYA KEMBALIKAN ---
                { name: 'Berita', icon: <Newspaper size={20} />, href: '#news', action: () => setCurrentView('news') }, 
                { name: 'Partners', icon: <Handshake size={20} />, href: '#partners', action: () => { setCurrentView('landing'); setTimeout(() => document.getElementById('partners')?.scrollIntoView({behavior: 'smooth'}), 100); } },
                { name: 'Pricing', icon: <Crown size={20} />, href: '#pricing', action: () => setCurrentView('pricing') },
            ];

            return (
                <div className="flex h-screen w-full bg-[#05020a] overflow-hidden relative no-scroll-x">
                    {/* SIDEBAR */}
                    <div className={`fixed inset-y-0 left-0 z-50 transition-all duration-300 transform ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full'} lg:relative lg:translate-x-0 lg:flex flex-col h-full glass-sidebar ${isSidebarExpanded ? 'w-72' : 'w-20'} border-r border-white/5 overflow-hidden`}>
                        <div className={`p-6 flex items-center ${isSidebarExpanded ? 'justify-between' : 'justify-center'} border-b border-white/5 h-20 shrink-0`}>
                             {isSidebarExpanded && <div className="flex items-center gap-3 animate-fade-in"><img src={AINA_LOGO} alt="AINA Logo" className="w-8 h-8 rounded-lg object-cover border border-white/10"/><h1 className="text-xl font-bold text-white">AINA</h1></div>}
                             <button onClick={() => { if (window.innerWidth < 1024) setIsMobileMenuOpen(false); else setIsSidebarExpanded(!isSidebarExpanded); }} className="p-1.5 text-gray-400 hover:text-white rounded-lg hover:bg-white/5">{window.innerWidth < 1024 ? <X size={20} /> : (isSidebarExpanded ? <PanelLeftClose size={20}/> : <Menu size={24}/>)}</button>
                        </div>
                        <div className="flex-1 py-6 px-3 space-y-2 overflow-y-auto custom-scrollbar h-full">
                            {navLinks.map((link) => (
                                <button key={link.name} onClick={() => { link.action(); if(window.innerWidth < 1024) setIsMobileMenuOpen(false); }} className={`w-full flex items-center gap-3 px-3 py-3 rounded-xl transition-all duration-200 group ${ (currentView === 'news' && link.name === 'Berita') ? 'bg-purple-600 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white' } ${!isSidebarExpanded && 'justify-center'}`}>
                                    <div className="p-1.5 rounded-lg shrink-0 bg-white/5 group-hover:bg-white/10">{link.icon}</div>
                                    {isSidebarExpanded && <span className="font-medium text-sm">{link.name}</span>}
                                </button>
                            ))}
                            <div className="mt-8"><button onClick={() => { setCurrentView('chat_app'); if(window.innerWidth < 1024) setIsMobileMenuOpen(false); }} className={`w-full flex items-center gap-3 px-3 py-3 rounded-xl transition-all duration-200 group ${currentView === 'chat_app' ? 'bg-purple-600 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white'} ${!isSidebarExpanded && 'justify-center'}`}><div className="p-1.5 rounded-lg shrink-0 bg-white/5 group-hover:bg-white/10"><MessageSquare size={18}/></div>{isSidebarExpanded && <span className="font-medium text-sm">Tanya AINA</span>}</button></div>
                            
                            {/* ADDED LIVE CLOCK WIDGET */}
                            {isSidebarExpanded && (
                                <div className="animate-fade-in border-t border-white/5 pt-4 mt-4 space-y-6 pb-20">
                                    <LiveClockWidget />
                                    <PrayerTimesWidget />
                                    <CurrencyConverter />
                                </div>
                            )}
                        </div>
                    </div>
                    {isMobileMenuOpen && <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden" onClick={() => setIsMobileMenuOpen(false)}></div>}

                    {/* MAIN CONTENT WRAPPER - STRICT WIDTH CONTROL */}
                    <div className={`flex-1 flex flex-col h-screen transition-all duration-300 relative ${currentView === 'chat_app' ? 'overflow-hidden' : 'overflow-hidden'} w-full max-w-full`}>
                        <div className="absolute inset-0 pointer-events-none z-0">
                            <div className="purple-blob top-[-10%] right-[-10%] w-[600px] h-[600px] opacity-20 bg-purple-600/30"></div>
                            <div className="purple-blob bottom-[20%] left-[-10%] w-[500px] h-[500px] opacity-15 bg-blue-600/20"></div>
                        </div>

                        {/* NAVBAR */}
                        <div className="w-full h-16 glass-panel border-b border-white/5 flex items-center justify-between px-6 z-40 shrink-0">
                            <div className="lg:hidden flex items-center gap-3"><button onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)} className="p-2 text-white"><Menu size={24} /></button><div className="flex items-center gap-2"><img src={AINA_LOGO} alt="AINA" className="w-8 h-8 rounded-lg object-cover border border-white/10"/><span className="font-bold text-xl text-white">AINA</span></div></div>
                            <div className="hidden lg:flex items-center text-gray-400 text-sm gap-2"><button onClick={() => setCurrentView('landing')} className="hover:text-white flex items-center gap-1"><Home size={14}/> Home</button><span className="text-gray-600">/</span><span className="text-purple-300 font-medium">{currentView === 'landing' ? 'Beranda' : currentView.charAt(0).toUpperCase() + currentView.slice(1)}</span></div>
                            <div className="flex items-center gap-4 md:gap-6">
                                <button onClick={handleTrainAiClick} className="flex items-center gap-2 text-sm font-medium text-purple-300 hover:text-white transition-colors px-3 py-1.5 rounded-lg hover:bg-white/5 border border-white/5">
                                    <BrainCircuit size={16}/> <span className="hidden md:inline">Latih AI</span>
                                </button>
                                {currentUser ? (
                                    <button onClick={() => setCurrentView('profile')} className="flex items-center gap-3 pl-1 pr-3 py-1 rounded-full glass-panel hover:bg-white/10 transition-all group border border-white/10">
                                        <div className="w-7 h-7 rounded-full bg-purple-600 flex items-center justify-center text-xs font-bold border border-purple-400 overflow-hidden">{userProfile.photo ? <img src={userProfile.photo} className="w-full h-full object-cover" /> : (currentUser.email ? currentUser.email.charAt(0).toUpperCase() : 'U')}</div>
                                        <span className="text-sm font-medium text-gray-200 group-hover:text-white max-w-[80px] truncate">{getDisplayName()}</span>
                                    </button>
                                ) : (<button onClick={() => { setAuthMode('login'); setIsAuthModalOpen(true); }} className="bg-white text-[#0A0217] px-4 py-1.5 rounded-full text-xs font-bold hover:bg-purple-100 transition-all shadow-lg shadow-purple-500/20">Masuk</button>)}
                            </div>
                        </div>

                        {/* DYNAMIC SCROLL AREA */}
                        <div className={`flex-1 relative z-10 ${currentView === 'chat_app' ? 'overflow-hidden flex flex-col' : 'overflow-y-auto custom-scrollbar scroll-smooth'} w-full`} id="main-scroll">
                            
                            {/* --- LANDING PAGE --- */}
                            {currentView === 'landing' && (
                                <div className="pb-0 w-full">
                                    {/* HERO */}
                                    <section className="pt-12 pb-16 md:pt-24 md:pb-20 px-6 md:px-12 relative">
                                        <div className="flex flex-col xl:flex-row items-center gap-12 md:gap-16">
                                            <div className="w-full xl:w-[60%] space-y-6 lg:space-y-8 text-center xl:text-left">
                                                <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full glass-panel border-purple-500/30 mx-auto xl:mx-0"><span className="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span><span className="text-xs font-bold text-purple-200 tracking-widest uppercase">AI Ecosystem Masisir</span></div>
                                                <div><h1 className="text-7xl md:text-8xl lg:text-9xl font-extrabold leading-none tracking-tighter -ml-1 hero-title-gradient block -mb-2 md:-mb-5 pb-2">AINA</h1><span className="text-white text-4xl md:text-5xl lg:text-7xl font-semibold tracking-tight">for Masisir.</span></div>
                                                <p className="text-lg md:text-xl text-gray-400 max-w-xl mx-auto xl:mx-0 leading-relaxed">Asisten cerdas untuk urusan hidup dan belajar di Mesir. <br/><span className="text-gray-300 font-medium">Mari saling memudahkan!</span></p>
                                                <div className="flex flex-wrap gap-4 pt-4 justify-center xl:justify-start"><button onClick={() => setCurrentView('chat_app')} className="px-8 py-4 bg-white text-[#0A0217] rounded-full font-bold text-lg hover:bg-purple-50 transition-all flex items-center gap-2 shadow-xl shadow-white/10 group">Coba Web App</button><button onClick={() => document.getElementById('features')?.scrollIntoView({behavior: 'smooth'})} className="px-8 py-4 glass-panel rounded-full font-bold text-lg hover:bg-white/10 transition-all flex items-center gap-2">Fitur Utama</button></div>
                                            </div>
                                            
                                            {/* DEMO CHAT (DYNAMIC) */}
                                            <div className="w-full xl:w-[40%] relative group cursor-pointer mt-8 xl:mt-0" onClick={() => setCurrentView('chat_app')}>
                                                <div className="purple-blob top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-purple-500/20 blur-[80px] group-hover:bg-purple-500/30 transition-all"></div>
                                                <div className="relative glass-panel rounded-3xl p-6 md:p-8 shadow-2xl border-white/10 bg-[#0A0217]/80 backdrop-blur-xl transform xl:rotate-2 xl:group-hover:rotate-0 transition-all duration-500">
                                                    <div className="flex items-center justify-between mb-6 border-b border-white/10 pb-4"><div className="flex items-center gap-3"><div className="w-10 h-10 rounded-full bg-gradient-to-tr from-purple-600 to-indigo-600 flex items-center justify-center border border-white/20 shadow-lg shadow-purple-500/30 overflow-hidden"><img src={AINA_LOGO} alt="AINA Avatar" className="w-full h-full object-cover"/></div><div><h3 className="font-bold text-white">AINA</h3><p className="text-[10px] text-green-400 font-mono flex items-center gap-1"><span className="w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"></span> ONLINE</p></div></div></div>
                                                    <div className="space-y-4 mb-6 font-sans text-sm">
                                                        <div className="bubble-ai p-4 rounded-2xl rounded-tl-sm text-gray-200 shadow-sm msg-animate" style={{animationDelay: '0.1s'}}>{heroChat.q}</div>
                                                        <div className="bubble-user p-4 rounded-2xl rounded-tr-sm text-white self-end ml-auto w-fit shadow-md msg-animate" style={{animationDelay: '0.5s'}}>{heroChat.a}</div>
                                                    </div>
                                                    <div className="absolute -bottom-4 left-1/2 transform -translate-x-1/2 md:right-4 md:left-auto md:transform-none bg-white text-black px-5 py-2.5 rounded-full font-bold shadow-xl shadow-purple-500/20 flex items-center gap-2 text-sm group-hover:scale-110 transition-transform cursor-pointer border-2 border-purple-500 whitespace-nowrap">Klik untuk Chat</div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    {/* MEANING */}
                                    <section id="meaning" className="py-10 relative bg-white/[0.02]">
                                        <div className="container mx-auto px-6"><div className="glass-panel p-6 md:p-8 rounded-[2rem] flex flex-col md:flex-row items-center gap-8 border border-white/10 bg-[#0f0518]/50 backdrop-blur-xl"><div className="md:w-1/3 text-center md:text-left"><div className="text-purple-400 text-xs font-bold uppercase tracking-widest mb-1">Tentang Kami</div><h2 className="text-2xl md:text-4xl font-bold mb-2">Apa itu AINA?</h2><p className="text-gray-300 text-base leading-relaxed">Dalam bahasa Arab, <strong>"AI-NA"</strong> adalah AI Kita.<br/><span className="text-white font-bold border-b border-purple-500">Satu aplikasi, semua solusi.</span></p></div><div className="md:w-2/3 grid grid-cols-1 sm:grid-cols-3 gap-4 w-full">{[{icon:<Users size={24}/>, t:"Komunitas", d:"Dari Masisir untuk Masisir."}, {icon:<LayoutGrid size={24}/>, t:"Terpusat", d:"Info valid satu pintu."}, {icon:<Zap size={24}/>, t:"Lokal", d:"Paham banget Mesir."}].map((x,i)=>(<div key={i} className="bg-purple-900/20 p-4 rounded-xl border border-white/5 hover:bg-white/5 transition-all group flex flex-col items-center md:items-start text-center md:text-left"><div className="mb-2 group-hover:scale-110 transition-transform">{x.icon}</div><h3 className="font-bold mb-1 text-sm">{x.t}</h3><p className="text-xs text-gray-400">{x.d}</p></div>))}</div></div></div>
                                    </section>
                                    
                                    {/* MASALAH KLASIK (UPDATED TEXT & ICONS) */}
                                    <section className="py-16 px-6 relative">
                                        <div className="purple-blob bottom-0 left-20 w-80 h-80 bg-red-600/10 blur-[100px]"></div>
                                        <div className="max-w-6xl mx-auto">
                                            <h2 className="text-2xl md:text-4xl font-bold text-center mb-10">Masalah Klasik <span className="text-gray-500">Masisir</span></h2>
                                            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3">
                                                {[
                                                    {t:"Info Tercecer", d:"Informasi penting sering tenggelam di ratusan grup WA yang berisik.", i:<MessageCircle size={20}/>},
                                                    {t:"Birokrasi", d:"Bingung alur visa & iqamah yang sering berubah tanpa pemberitahuan.", i:<FileSignature size={20}/>},
                                                    {t:"Info Talaqi", d:"Susah cari jadwal pengajian syeikh yang valid dan lokasi tepat.", i:<GraduationCap size={20}/>},
                                                    {t:"Syaqqah", d:"Lelah mencari flat kosong atau teman sakan yang cocok.", i:<Key size={20}/>},
                                                    {t:"Transport", d:"Rute angkot dan bus di Kairo yang membingungkan pendatang.", i:<Bus size={20}/>},
                                                    {t:"Kurs Labil", d:"Pusing hitung konversi EGP ke Rupiah yang naik turun.", i:<Coins size={20}/>}
                                                ].map((p,i)=>(
                                                    <div key={i} className="glass-panel p-4 rounded-xl flex flex-col items-center text-center gap-2 hover:-translate-y-1 transition-all hover:shadow-lg hover:shadow-purple-900/20">
                                                        <div className="bg-purple-600/20 p-2.5 rounded-full mb-1 border border-purple-500/20">{p.i}</div>
                                                        <div><h4 className="font-bold text-sm md:text-sm text-white">{p.t}</h4><p className="text-xs text-gray-400 leading-tight">{p.d}</p></div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </section>

                                    {/* SOLUSI AINA */}
                                    <section className="py-16 bg-white/[0.02] border-y border-white/5 relative">
                                        <div className="purple-blob top-0 right-0 w-full h-full bg-purple-900/10 blur-[150px]"></div>
                                        <div className="container mx-auto px-6 relative z-10">
                                            <h2 className="text-2xl md:text-4xl font-bold text-center mb-10">Solusi AINA</h2>
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                                {[
                                                    {l:"Terpusat", d:"All-in-one platform.", i:<LayoutGrid size={24}/>}, 
                                                    {l:"Asisten AI", d:"Tanya jawab 24/7.", i:<Sparkles size={24}/>}, 
                                                    {l:"Real-time", d:"Info live & valid.", i:<Zap size={24}/>}, 
                                                    {l:"Komunitas", d:"Dari kita untuk kita.", i:<Users size={24}/>}
                                                ].map((s,i)=>(
                                                    <div key={i} className="glass-panel p-5 rounded-xl text-center flex flex-col items-center gap-2 hover:bg-white/10 transition-all group">
                                                        <div className="bg-purple-600/20 p-3 rounded-full mb-1 group-hover:scale-110 transition-transform shadow-lg border border-purple-500/20">{s.i}</div>
                                                        <h3 className="font-bold text-sm md:text-base">{s.l}</h3>
                                                        <p className="text-xs text-gray-400 leading-relaxed">{s.d}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </section>

                                    {/* FEATURES (UPDATED) */}
                                    <section id="features" className="py-16 px-6 relative">
                                        <div className="container mx-auto max-w-6xl">
                                            <div className="flex flex-col xl:flex-row gap-10 xl:gap-16">
                                                <div className="flex-1">
                                                    <h2 className="text-2xl md:text-4xl font-bold mb-8 md:text-center xl:text-left">Fitur Utama</h2>
                                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-6">
                                                        {[
                                                            {
                                                                title: "Admin Navigator", 
                                                                desc: "Panduan admin Mesir step-by-step, checklist dokumen, template surat, dan reminder deadline.", 
                                                                icon: <FileSignature size={20} />,
                                                                query: "Bantu saya urus administrasi dan checklist dokumen"
                                                            },
                                                            {
                                                                title: "Academic Scholar AI", 
                                                                desc: "Penjelasan kitab, ringkasan kuliah, tutor nahwu-sharf, dan jawaban akademik berbasis dalil.", 
                                                                icon: <GraduationCap size={20} />,
                                                                query: "Bantu jelaskan materi kitab dan nahwu sharf"
                                                            },
                                                            {
                                                                title: "Life Helper Masisir", 
                                                                desc: "Info hidup di Mesir: transport, rumah sakit, toko Indonesia, biaya hidup, dan mini travel guide.", 
                                                                icon: <MapPin size={20} />,
                                                                query: "Berikan info seputar kehidupan di Mesir dan transport"
                                                            },
                                                            {
                                                                title: "Arabic Booster", 
                                                                desc: "Koreksi grammar, terjemahan Arab Fushah & Baladi, serta latihan baca kitab kuning.", 
                                                                icon: <Languages size={20} />,
                                                                query: "Bantu koreksi bahasa Arab dan terjemahan"
                                                            },
                                                            {
                                                                title: "Visa & Travel Assistant", 
                                                                desc: "Reminder visa/paspor, panduan perpanjangan, info biaya resmi, dan integrasi pencarian tiket Temantiket.", 
                                                                icon: <Plane size={20} />,
                                                                query: "Info perpanjangan visa dan tiket pesawat"
                                                            },
                                                            {
                                                                title: "Spiritual & Mental Support", 
                                                                desc: "Dzikir otomatis, ayat/hadits harian, nasihat personal, dan ruang curhat aman.", 
                                                                icon: <Sparkles size={20} />, // Using Sparkles as proxy for spiritual
                                                                query: "Saya butuh nasihat dan motivasi hari ini"
                                                            }
                                                        ].map((f,i)=>(
                                                            <div key={i} onClick={() => handleFeatureClick(f.query)} className="glass-panel p-5 rounded-xl flex items-start gap-4 hover:bg-white/10 transition-all cursor-pointer group hover:border-purple-500/50">
                                                                <div className="w-10 h-10 rounded-full bg-purple-600/20 flex items-center justify-center shrink-0 border border-purple-500/30 mt-1 group-hover:scale-110 transition-transform text-purple-300">
                                                                    {f.icon}
                                                                </div>
                                                                <div>
                                                                    <span className="font-bold text-base md:text-lg block mb-1 leading-tight group-hover:text-purple-300 transition-colors">{f.title}</span>
                                                                    <span className="text-xs md:text-sm text-gray-400 leading-relaxed block">{f.desc}</span>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    {/* PARTNER & COLLABORATION SECTION (MATCHING TITLE) */}
                                    <section id="partners" className="py-12 px-6 relative border-t border-white/5">
                                        <div className="container mx-auto flex flex-col items-center justify-center gap-8 text-center">
                                            <h2 className="text-2xl md:text-4xl font-bold md:text-center xl:text-left mb-4">Kolaborator AINA</h2>
                                            <div className="flex flex-wrap justify-center gap-6 md:gap-10 items-center opacity-80 hover:opacity-100 transition-opacity grayscale hover:grayscale-0">
                                                <div className="flex items-center gap-2 text-white font-bold text-sm md:text-xl"><Globe size={18} className="md:w-6 md:h-6"/> PPMI</div>
                                                <div className="flex items-center gap-2 text-white font-bold text-sm md:text-xl"><Plane size={18} className="md:w-6 md:h-6"/> Temantiket</div>
                                                <div className="flex items-center gap-2 text-purple-400 font-bold text-sm md:text-xl"><BrainCircuit size={18} className="md:w-6 md:h-6"/> AIGYPT</div>
                                            </div>
                                            <div className="h-px w-20 bg-white/10 md:hidden"></div>
                                            <button onClick={() => window.open('https://wa.me/6281311506025', '_blank')} className="px-6 py-3 rounded-full border border-white/20 hover:bg-white/10 text-sm md:text-base font-medium flex items-center gap-2 transition-all group bg-white/5">
                                                <Handshake size={16} className="text-purple-400 group-hover:text-white transition-colors"/> Mari Berkolaborasi!
                                            </button>
                                        </div>
                                    </section>

                                    {/* CTA */}
                                    <section className="py-32 text-center relative overflow-hidden"><div className="relative z-10 px-6"><h2 className="text-4xl md:text-8xl font-bold mb-4 tracking-tighter">Bantu AINA Pintar!</h2><p className="text-lg md:text-xl text-gray-400 mb-10 max-w-2xl mx-auto">Kontribusi data kamu bikin hidup Masisir lebih mudah.</p><div className="flex flex-col sm:flex-row justify-center gap-4"><button onClick={handleTrainAiClick} className="px-8 py-4 bg-white text-black rounded-full font-bold hover:bg-gray-200 transition-all shadow-2xl hover:shadow-white/20 text-base">Mulai Mengajar</button><button onClick={() => window.open('https://t.me/+KETfQVCDLbpjY2Zl', '_blank')} className="px-8 py-4 glass-panel rounded-full font-bold hover:bg-white/10 transition-all text-base flex items-center justify-center gap-2"><Users size={18}/> Gabung Komunitas</button></div></div></section>
                                    
                                    {/* FOOTER */}
                                    <div className="p-10 border-t border-white/10 text-center text-gray-500 text-sm bg-black/40 backdrop-blur-lg">
                                        <div className="mb-6 flex flex-col gap-2"><p className="font-bold text-white text-lg mb-1">AINA &copy; 2025</p><p className="text-xs uppercase tracking-widest text-purple-400 font-bold">Powered by AIGYPT</p></div>
                                        <div className="flex flex-col md:flex-row justify-center items-center gap-4 md:gap-8 mb-6 text-xs">
                                            <a href="https://wa.me/6281311506025" target="_blank" className="hover:text-white transition-colors flex items-center gap-2"><MessageCircle size={14}/> +62 813-1150-6025 (Kontak)</a>
                                            <span className="hidden md:inline text-gray-700">|</span>
                                            <a href="https://instagram.com/ai.gypt" target="_blank" className="hover:text-purple-400 transition-colors flex items-center gap-2">instagram.com/ai.gypt</a>
                                        </div>
                                        <p className="text-[10px] opacity-40">Dibuat dengan â¤ï¸ untuk Masisir.</p>
                                    </div>
                                </div>
                            )}

                            {/* --- CHAT APP --- */}
                            {currentView === 'chat_app' && (
                                <div className="h-full p-4 lg:p-6 flex flex-col">
                                    <div className="glass-panel w-full h-full rounded-3xl flex flex-col overflow-hidden relative shadow-2xl border-white/10 bg-[#0A0217]/60 backdrop-blur-2xl chat-bg-pattern">
                                        <div className="p-4 border-b border-white/10 flex justify-between items-center bg-white/5 shrink-0">
                                            <div className="flex items-center gap-3 flex-1">
                                                <button onClick={() => setCurrentView('landing')} className="p-1.5 text-gray-400 hover:text-white hover:bg-white/5 rounded-lg transition-colors"><ArrowLeft size={20}/></button>
                                                <div className="w-10 h-10 rounded-full bg-gradient-to-tr from-purple-600 to-indigo-600 flex items-center justify-center border border-white/20 shadow-lg shadow-purple-500/30 overflow-hidden"><img src={AINA_LOGO} alt="AINA Avatar" className="w-full h-full object-cover"/></div>
                                                <div><h3 className="font-bold text-white">AINA Chat</h3><p className="text-[10px] text-gray-400 flex items-center gap-1"><span className="w-1.5 h-1.5 bg-green-400 rounded-full"></span> Mode: {activeModel.toUpperCase()}</p></div>
                                            </div>
                                            <button onClick={clearChat} className="text-xs text-gray-400 hover:text-white flex items-center gap-1 px-2 py-1 rounded hover:bg-white/5 transition-all"><RefreshCw size={12}/> Reset</button>
                                        </div>
                                        <div className="flex-1 overflow-y-auto p-4 md:p-6 space-y-6 custom-scrollbar scroll-smooth">
                                            {chatHistory.map((msg, i) => (<div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'} msg-animate`}><div className={`max-w-[85%] px-6 py-4 rounded-2xl text-sm md:text-base leading-relaxed shadow-lg ${msg.role === 'user' ? 'bubble-user text-white rounded-tr-none' : 'bubble-ai text-gray-200 rounded-tl-none'}`}><FormattedMessage text={msg.text} /></div></div>))}
                                            {isAiLoading && <div className="flex justify-start msg-animate"><div className="bubble-ai px-5 py-3 rounded-2xl rounded-tl-none flex items-center gap-3"><Loader2 size={16} className="animate-spin text-purple-500"/><span className="text-xs text-gray-400 italic">Sedang mengetik...</span></div></div>}
                                            <div ref={chatEndRef} className="h-2"/>
                                        </div>
                                        <div className="p-4 bg-white/5 border-t border-white/10 backdrop-blur-md shrink-0"><ModelSelector activeModel={activeModel} setActiveModel={setActiveModel}/><div className="relative mt-3"><textarea value={chatInput} onChange={(e)=>setChatInput(e.target.value)} onKeyPress={(e)=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSendMessage()}}} placeholder={`Tanya ${activeModel}...`} className="w-full bg-black/40 rounded-2xl border border-white/10 p-4 pr-16 resize-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500/50 outline-none text-sm md:text-base h-16 custom-scrollbar text-white placeholder-gray-500 transition-all"/><button onClick={() => handleSendMessage()} disabled={!chatInput.trim()||isAiLoading} className="absolute right-3 top-3 p-2.5 bg-purple-600 rounded-xl hover:bg-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-white shadow-lg hover:shadow-purple-500/30"><Send size={20}/></button></div></div>
                                    </div>
                                </div>
                            )}

                            {/* --- NEWS VIEW (RESTORED & UPGRADED) --- */}
                            {currentView === 'news' && (
                                <div className="p-8 md:p-12 max-w-7xl mx-auto">
                                    <NewsPage />
                                </div>
                            )}

                            {/* --- PRICING VIEW --- */}
                            {currentView === 'pricing' && (
                                <div className="p-8 md:p-12 max-w-7xl mx-auto min-h-screen flex flex-col items-center justify-center">
                                    <div className="text-center mb-12">
                                        <h2 className="text-3xl md:text-5xl font-bold mb-4">Upgrade ke <span className="text-purple-400">AINA Premium</span></h2>
                                        <p className="text-gray-400 text-lg">Nikmati akses tanpa batas dan fitur eksklusif.</p>
                                    </div>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl">
                                        {/* Free Plan */}
                                        <div className="glass-panel p-8 rounded-3xl border border-white/10 flex flex-col relative overflow-hidden">
                                            <div className="mb-6">
                                                <h3 className="text-xl font-bold text-gray-300 mb-2">Paket Santri</h3>
                                                <div className="text-4xl font-bold text-white">Gratis<span className="text-sm font-normal text-gray-500 ml-2">/ selamanya</span></div>
                                            </div>
                                            <ul className="space-y-4 mb-8 flex-1">
                                                <li className="flex items-center gap-3 text-gray-300"><Check size={18} className="text-green-400"/> Akses Chat Bot Dasar</li>
                                                <li className="flex items-center gap-3 text-gray-300"><Check size={18} className="text-green-400"/> 10 Pesan / Hari</li>
                                                <li className="flex items-center gap-3 text-gray-300"><Check size={18} className="text-green-400"/> Akses Info Masisir</li>
                                                <li className="flex items-center gap-3 text-gray-500"><X size={18}/> Prioritas Support</li>
                                            </ul>
                                            <button onClick={() => setCurrentView('chat_app')} className="w-full py-3 rounded-xl border border-white/20 hover:bg-white/5 transition-all font-bold">Lanjut Gratis</button>
                                        </div>

                                        {/* Premium Plan */}
                                        <div className="glass-panel p-8 rounded-3xl border border-purple-500/50 flex flex-col relative overflow-hidden bg-gradient-to-br from-purple-900/20 to-transparent">
                                            <div className="absolute top-0 right-0 bg-purple-600 text-white text-xs font-bold px-3 py-1 rounded-bl-xl">POPULER</div>
                                            <div className="mb-6">
                                                <h3 className="text-xl font-bold text-purple-300 mb-2">Paket Sultan</h3>
                                                <div className="text-4xl font-bold text-white">Rp 30rb<span className="text-sm font-normal text-gray-500 ml-2">/ bulan</span></div>
                                                <p className="text-xs text-gray-500 mt-1">atau Rp 350rb / tahun (Hemat 17%)</p>
                                            </div>
                                            <ul className="space-y-4 mb-8 flex-1">
                                                <li className="flex items-center gap-3 text-white"><Check size={18} className="text-purple-400"/> <strong>Unlimited</strong> Chat Bot</li>
                                                <li className="flex items-center gap-3 text-white"><Check size={18} className="text-purple-400"/> Akses Model Pintar (Scholar)</li>
                                                <li className="flex items-center gap-3 text-white"><Check size={18} className="text-purple-400"/> Prioritas Support</li>
                                                <li className="flex items-center gap-3 text-white"><Check size={18} className="text-purple-400"/> Badge "Sultan" di Profil</li>
                                            </ul>
                                            <div className="flex flex-col gap-2">
                                                 <button onClick={handleSubscribe} className="w-full py-3 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 hover:shadow-lg hover:shadow-purple-500/30 transition-all font-bold">Langganan Sekarang</button>
                                                 <button onClick={()=>setIsRedeemModalOpen(true)} className="text-xs text-purple-300 hover:text-white underline">Punya Kode Akses?</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* --- PROFILE & PERSONALIZE --- */}
                            {(currentView === 'profile' || currentView === 'personalize') && (
                                <div className="p-8 md:p-12 max-w-4xl mx-auto min-h-screen">
                                    <div className="glass-panel p-8 rounded-3xl mb-8 border-l-4 border-purple-500"><h1 className="text-3xl md:text-4xl font-bold mb-2">{currentView === 'profile' ? 'Profil Kontributor' : 'Training Center'}</h1><p className="text-gray-400">Area khusus untuk Masisir yang ingin berkontribusi.</p></div>
                                    {/* Ensure file input is always rendered to avoid Ref errors */}
                                    <input type="file" ref={fileInputRef} className="hidden" onChange={handlePhotoUpload}/>

                                    {currentView === 'profile' && (
                                        <div className="space-y-8">
                                            <div className="glass-panel p-8 rounded-3xl flex flex-col sm:flex-row items-center gap-8 mb-8">
                                                <div className="w-24 h-24 rounded-full bg-purple-500/20 border-2 border-purple-500 p-1 shrink-0 relative">
                                                    <div className="w-full h-full rounded-full overflow-hidden bg-black/50 flex items-center justify-center relative group cursor-pointer" onClick={() => fileInputRef.current && fileInputRef.current.click()}>
                                                        {userProfile.photo ? <img src={userProfile.photo} className="w-full h-full object-cover"/> : <span className="text-2xl font-bold text-purple-300">{currentUser?.email?.[0]?.toUpperCase() || 'U'}</span>}
                                                        <div className="absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"><Camera size={20}/></div>
                                                    </div>
                                                    {isPremium && <div className="absolute -top-2 -right-2 bg-yellow-500 text-black p-1.5 rounded-full shadow-lg border-2 border-[#05020a]"><Crown size={14}/></div>}
                                                </div>
                                                
                                                <div className="flex-1 w-full text-center sm:text-left">
                                                    <div className="flex items-center justify-center sm:justify-between mb-2">
                                                        <div className="flex items-center gap-2 justify-center sm:justify-start">
                                                            <h3 className="text-2xl font-bold">{getDisplayName()}</h3>
                                                            {isPremium && <span className="bg-purple-600 text-white text-[10px] px-2 py-0.5 rounded-full font-bold uppercase tracking-wider">Sultan</span>}
                                                        </div>
                                                        <button onClick={()=>setIsEditingName(!isEditingName)} className="p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white"><Edit3 size={18}/></button>
                                                    </div>
                                                    {isEditingName && <div className="flex gap-2 mb-4"><input value={tempName} onChange={e=>setTempName(e.target.value)} className="bg-black/40 border border-white/20 rounded px-3 py-1 text-sm w-full"/><button onClick={handleSaveName} className="text-green-400"><Check size={18}/></button></div>}
                                                    <div className="flex justify-center sm:justify-start gap-4 text-sm">
                                                        <div className="bg-purple-600/20 px-3 py-1 rounded-lg text-purple-300 border border-purple-500/30">Level: <strong>Novice</strong></div>
                                                        <div className="bg-green-600/20 px-3 py-1 rounded-lg text-green-300 border border-green-500/30">XP: <strong>150</strong></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="grid grid-cols-3 gap-4"><div className="glass-panel p-4 rounded-xl text-center"><h4 className="text-xl md:text-2xl font-bold text-white">0</h4><p className="text-[10px] md:text-xs text-gray-400 uppercase tracking-wider mt-1">Kontribusi</p></div><div className="glass-panel p-4 rounded-xl text-center"><h4 className="text-xl md:text-2xl font-bold text-green-400">0</h4><p className="text-[10px] md:text-xs text-gray-400 uppercase tracking-wider mt-1">Approved</p></div><div className="glass-panel p-4 rounded-xl text-center"><h4 className="text-xl md:text-2xl font-bold text-purple-400">Novice</h4><p className="text-[10px] md:text-xs text-gray-400 uppercase tracking-wider mt-1">Rank</p></div></div>
                                            
                                            {/* Weekly Missions (NEW) */}
                                            <div className="glass-panel p-6 rounded-2xl">
                                                <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><Target size={20} /> Misi Mingguan</h3>
                                                <div className="space-y-3">
                                                    {[{title: "Lengkapi Profil", xp: "+50 XP", done: false}, {title: "Kirim 1 Info Valid", xp: "+100 XP", done: false}, {title: "Share AINA ke Teman", xp: "+200 XP", done: false}].map((mission, i) => (
                                                        <div key={i} className="flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/5">
                                                            <div className="flex items-center gap-3">
                                                                <div className={`w-5 h-5 rounded-full border-2 ${mission.done ? 'bg-green-500 border-green-500' : 'border-gray-500'}`}></div>
                                                                <span className={mission.done ? 'line-through text-gray-500' : 'text-gray-200'}>{mission.title}</span>
                                                            </div>
                                                            <span className="text-xs font-bold text-yellow-400">{mission.xp}</span>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    <div className="glass-panel p-8 rounded-3xl mt-8"><h3 className="text-xl font-bold mb-6 flex items-center gap-2 text-white"><BrainCircuit size={20} /> Input Data Baru</h3><div className="space-y-5"><div><label className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1.5 block">Kategori</label><select value={knowledgeCategory} onChange={e=>setKnowledgeCategory(e.target.value)} className="w-full bg-black/40 border border-white/10 rounded-xl p-3.5 outline-none focus:border-purple-500 text-white appearance-none transition-all"><option value="">Pilih Kategori...</option>{["Akademik", "Syaqqah", "Logistik", "Transport", "Visa/Iqamah", "Kajian Kitab", "Kuliner", "Jual Beli", "Lainnya"].map(c=><option key={c} value={c} className="bg-[#0A0217]">{c}</option>)}</select></div><div><label className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1.5 block">Judul Informasi</label><input value={knowledgeTitle} onChange={e=>setKnowledgeTitle(e.target.value)} placeholder="Contoh: Jadwal Talaqi Syeikh Yusri" className="w-full bg-black/40 border border-white/10 rounded-xl p-3.5 outline-none focus:border-purple-500 text-white placeholder-gray-600 transition-all"/></div><div><label className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1.5 block">Detail Lengkap</label><textarea value={knowledgeInput} onChange={e=>setKnowledgeInput(e.target.value)} placeholder="Tuliskan detailnya di sini (Lokasi, Jam, Syarat, dll)..." className="w-full bg-black/40 border border-white/10 rounded-xl p-3.5 h-40 outline-none focus:border-purple-500 text-white placeholder-gray-600 resize-none transition-all custom-scrollbar"/></div><button onClick={handleSendData} disabled={isSaving} className="w-full py-4 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 rounded-xl font-bold text-lg shadow-lg shadow-purple-900/30 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed mt-4">{isSaving ? <><Loader2 className="animate-spin"/> Mengirim...</> : <><Save size={20}/> Kirim Data ke AINA</>}</button></div></div>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {/* AUTH MODAL (Overlay) */}
                    {isAuthModalOpen && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
                            <div className="glass-panel p-8 rounded-3xl w-full max-w-md relative animate-fade-in-up">
                                <button onClick={()=>setIsAuthModalOpen(false)} className="absolute top-4 right-4 p-2 text-gray-400 hover:text-white bg-white/5 rounded-full z-50 hover:bg-white/10 transition-all"><X size={24}/></button>
                                <h2 className="text-2xl font-bold text-center mb-2">{authMode==='login'?'Masuk AINA':'Daftar Baru'}</h2>
                                <p className="text-center text-sm text-purple-300 mb-6 bg-purple-500/10 py-2 rounded-lg border border-purple-500/20">Login atau buat akun untuk mendapatkan banyak benefit, berkontribusi dan bermanfaat untuk sesama!</p>
                                <form onSubmit={handleAuthSubmit} className="space-y-4"><div className="relative"><Users className="absolute left-3 top-3 text-gray-500" size={18}/><input type="email" placeholder="Email" className="w-full bg-black/40 border border-white/10 rounded-xl py-2.5 pl-10 outline-none focus:border-purple-500 text-white" required/></div><div className="relative"><Lock className="absolute left-3 top-3 text-gray-500" size={18}/><input type="password" placeholder="Password" className="w-full bg-black/40 border border-white/10 rounded-xl py-2.5 pl-10 outline-none focus:border-purple-500 text-white" required/></div><button type="submit" disabled={authLoading} className="w-full py-3 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl font-bold hover:shadow-lg hover:shadow-purple-500/30 transition-all">{authLoading?<Loader2 className="animate-spin mx-auto"/> : (authMode==='login'?'Masuk':'Daftar')}</button></form>
                                <p className="text-center text-xs text-gray-400 mt-4 cursor-pointer hover:text-white" onClick={()=>setAuthMode(authMode==='login'?'register':'login')}>{authMode==='login'?'Belum punya akun? Daftar':'Sudah punya akun? Masuk'}</p>
                            </div>
                        </div>
                    )}

                    {/* REDEEM CODE MODAL */}
                    {isRedeemModalOpen && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm">
                            <div className="glass-panel p-8 rounded-3xl w-full max-w-md relative text-center animate-popIn border border-purple-500/50">
                                <button onClick={()=>setIsRedeemModalOpen(false)} className="absolute top-4 right-4 p-2 text-gray-400 hover:text-white"><X size={24}/></button>
                                <div className="w-16 h-16 bg-purple-900/50 rounded-full flex items-center justify-center mx-auto mb-4 border border-purple-500"><Ticket size={32} className="text-purple-300"/></div>
                                <h2 className="text-2xl font-bold mb-2">Masukan Kode Akses</h2>
                                <p className="text-gray-300 text-sm mb-6">Punya kode promo atau voucher? Masukkan di sini untuk aktifkan Paket Sultan.</p>
                                <form onSubmit={handleRedeemSubmit}>
                                    <input 
                                        type="text" 
                                        value={redeemCode}
                                        onChange={(e) => setRedeemCode(e.target.value)}
                                        placeholder="Contoh: AINA-SULTAN" 
                                        className="w-full bg-black/40 border border-white/20 rounded-xl py-3 px-4 text-center outline-none focus:border-purple-500 text-white mb-4 uppercase font-mono tracking-widest"
                                        required
                                    />
                                    <button type="submit" className="w-full py-3 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl font-bold hover:shadow-lg hover:shadow-purple-500/30 transition-all">Aktifkan Sekarang</button>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* LIMIT MODAL (New) */}
                    {isLimitModalOpen && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm">
                            <div className="glass-panel p-8 rounded-3xl w-full max-w-md relative text-center animate-popIn border border-purple-500/50">
                                <button onClick={()=>setIsLimitModalOpen(false)} className="absolute top-4 right-4 p-2 text-gray-400 hover:text-white"><X size={24}/></button>
                                <div className="w-16 h-16 bg-purple-900/50 rounded-full flex items-center justify-center mx-auto mb-4 border border-purple-500"><Lock size={32} className="text-purple-300"/></div>
                                <h2 className="text-2xl font-bold mb-2">Yah, Kuota Habis! ðŸ˜…</h2>
                                <p className="text-gray-300 text-sm mb-6">Kamu udah pakai <strong>10 chat gratis</strong> hari ini. Langganan Premium yuk biar bisa chat sepuasnya!</p>
                                <button onClick={()=> { setIsLimitModalOpen(false); setCurrentView('pricing'); }} className="w-full py-3 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl font-bold hover:shadow-lg hover:shadow-purple-500/30 transition-all flex items-center justify-center gap-2"><Crown size={18}/> Upgrade Sekarang</button>
                                <button onClick={()=>setIsLimitModalOpen(false)} className="mt-4 text-gray-500 hover:text-white text-xs">Nanti deh, tunggu besok</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AinaLandingPage />);
    </script>
</body>
</html>